/*! For license information please see d9203f0beae7a6b38a05.js.LICENSE.txt */
import"./style.css";import*as THREE from"./three.min.js";import"./TweenMax.min.js";var game,Colors={red:15881030,white:14209233,brown:5845806,pink:16095342,brownDark:2300175,blue:5358803},newTime=(new Date).getTime(),oldTime=(new Date).getTime(),deltaTime=0,ennemiesPool=[],particlesPool=[],particlesInUse=[];function resetGame(){game={speed:0,initSpeed:35e-5,baseSpeed:35e-5,targetBaseSpeed:35e-5,incrementSpeedByTime:25e-7,incrementSpeedByLevel:5e-6,distanceForSpeedUpdate:100,speedLastUpdate:0,distance:0,ratioSpeedDistance:50,energy:100,ratioSpeedEnergy:3,level:1,levelLastUpdate:0,distanceForLevelUpdate:1e3,planeDefaultHeight:100,planeAmpHeight:80,planeAmpWidth:75,planeMoveSensivity:.005,planeRotXSensivity:8e-4,planeRotZSensivity:4e-4,planeFallSpeed:.001,planeMinSpeed:1.2,planeMaxSpeed:1.6,planeSpeed:0,planeCollisionDisplacementX:0,planeCollisionSpeedX:0,planeCollisionDisplacementY:0,planeCollisionSpeedY:0,seaRadius:600,seaLength:800,wavesMinAmp:5,wavesMaxAmp:20,wavesMinSpeed:.001,wavesMaxSpeed:.003,cameraFarPos:500,cameraNearPos:150,cameraSensivity:.002,coinDistanceTolerance:15,coinValue:3,coinsSpeed:.5,coinLastSpawn:0,distanceForCoinsSpawn:100,ennemyDistanceTolerance:10,ennemyValue:10,ennemiesSpeed:.6,ennemyLastSpawn:0,distanceForEnnemiesSpawn:50,status:"playing"},fieldLevel.innerHTML=Math.floor(game.level)}const canvas=document.querySelector("canvas.webgl"),scene=new THREE.Scene;scene.fog=new THREE.Fog(16243114,100,950);class Sea{constructor(){var e=new THREE.CylinderGeometry(600,600,800,40,10);e.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2)),e.mergeVertices();var a=e.vertices.length;this.waves=[];for(var s=0;s<a;s++){var n=e.vertices[s];this.waves.push({y:n.y,x:n.x,z:n.z,ang:Math.random()*Math.PI*2,amp:5+15*Math.random(),speed:.016+.032*Math.random()})}var t=new THREE.MeshPhongMaterial({color:Colors.blue,transparent:!0,opacity:.8,shading:THREE.FlatShading});this.mesh=new THREE.Mesh(e,t),this.mesh.receiveShadow=!0}}var sea,sky,airplane,coinsHolder,ennemiesHolder,particlesHolder;function createSea(){(sea=new Sea).mesh.position.y=-600,scene.add(sea.mesh)}Sea.prototype.moveWaves=function(){for(var e=this.mesh.geometry.vertices,a=e.length,s=0;s<a;s++){var n=e[s],t=this.waves[s];n.x=t.x+Math.cos(t.ang)*t.amp,n.y=t.y+Math.sin(t.ang)*t.amp,t.ang+=t.speed}this.mesh.geometry.verticesNeedUpdate=!0,sea.mesh.rotation.z+=.005};class Cloud{constructor(){this.mesh=new THREE.Object3D;for(var e=new THREE.BoxGeometry(20,20,20),a=new THREE.MeshPhongMaterial({color:Colors.white}),s=3+Math.floor(3*Math.random()),n=0;n<s;n++){var t=new THREE.Mesh(e,a);t.position.x=15*n,t.position.y=10*Math.random(),t.position.z=10*Math.random(),t.rotation.z=Math.random()*Math.PI*2,t.rotation.y=Math.random()*Math.PI*2;var i=.1+.9*Math.random();t.scale.set(i,i,i),t.castShadow=!0,t.receiveShadow=!0,this.mesh.add(t)}}}class Sky{constructor(){this.mesh=new THREE.Object3D,this.nClouds=20,this.clouds=[];for(var e=2*Math.PI/this.nClouds,a=0;a<this.nClouds;a++){var s=new Cloud;this.clouds.push(s);var n=e*a,t=game.seaRadius+150+200*Math.random();s.mesh.position.y=Math.sin(n)*t,s.mesh.position.x=Math.cos(n)*t,s.mesh.position.z=-300-500*Math.random(),s.mesh.rotation.z=n+Math.PI/2;var i=1+2*Math.random();s.mesh.scale.set(i,i,i),this.mesh.add(s.mesh)}}}function createSky(){(sky=new Sky).mesh.position.y=-600,scene.add(sky.mesh)}Sky.prototype.moveClouds=function(){for(var e=0;e<this.nClouds;e++)this.clouds[e];this.mesh.rotation.z+=game.speed*deltaTime};class AirPlane{constructor(){this.mesh=new THREE.Object3D,this.mesh.name="airPlane";var e=new THREE.BoxGeometry(80,50,50,1,1,1),a=new THREE.MeshPhongMaterial({color:Colors.red,shading:THREE.FlatShading});e.vertices[4].y-=10,e.vertices[4].z+=20,e.vertices[5].y-=10,e.vertices[5].z-=20,e.vertices[6].y+=30,e.vertices[6].z+=20,e.vertices[7].y+=30,e.vertices[7].z-=20;var s=new THREE.Mesh(e,a);s.castShadow=!0,s.receiveShadow=!0,this.mesh.add(s);var n=new THREE.BoxGeometry(20,50,50,1,1,1),t=new THREE.MeshPhongMaterial({color:Colors.white,shading:THREE.FlatShading}),i=new THREE.Mesh(n,t);i.position.x=50,i.castShadow=!0,i.receiveShadow=!0,this.mesh.add(i);var o=new THREE.BoxGeometry(15,20,5,1,1,1),r=new THREE.MeshPhongMaterial({color:Colors.red,shading:THREE.FlatShading}),h=new THREE.Mesh(o,r);h.position.set(-40,20,0),h.castShadow=!0,h.receiveShadow=!0,this.mesh.add(h);var l=new THREE.BoxGeometry(30,5,120,1,1,1),m=new THREE.MeshPhongMaterial({color:Colors.red,shading:THREE.FlatShading}),d=new THREE.Mesh(l,m);d.position.set(0,15,0),d.castShadow=!0,d.receiveShadow=!0,this.mesh.add(d);var c=new THREE.BoxGeometry(3,15,20,1,1,1),p=new THREE.MeshPhongMaterial({color:Colors.white,transparent:!0,opacity:.3,shading:THREE.FlatShading}),g=new THREE.Mesh(c,p);g.position.set(5,27,0),g.castShadow=!0,g.receiveShadow=!0,this.mesh.add(g);var E=new THREE.BoxGeometry(20,10,10,1,1,1);E.vertices[4].y-=5,E.vertices[4].z+=5,E.vertices[5].y-=5,E.vertices[5].z-=5,E.vertices[6].y+=5,E.vertices[6].z+=5,E.vertices[7].y+=5,E.vertices[7].z-=5;var w=new THREE.MeshPhongMaterial({color:Colors.brown,shading:THREE.FlatShading});this.propeller=new THREE.Mesh(E,w),this.propeller.castShadow=!0,this.propeller.receiveShadow=!0;var v=new THREE.BoxGeometry(1,80,10,1,1,1),M=new THREE.MeshPhongMaterial({color:Colors.brownDark,shading:THREE.FlatShading}),y=new THREE.Mesh(v,M);y.position.set(8,0,0),y.castShadow=!0,y.receiveShadow=!0;var T=y.clone();T.rotation.x=Math.PI/2,T.castShadow=!0,T.receiveShadow=!0,this.propeller.add(y),this.propeller.add(T),this.propeller.position.set(60,0,0),this.mesh.add(this.propeller);var u=new THREE.BoxGeometry(30,15,10,1,1,1),H=new THREE.MeshPhongMaterial({color:Colors.red,shading:THREE.FlatShading}),R=new THREE.Mesh(u,H);R.position.set(25,-20,25),this.mesh.add(R);var S=new THREE.BoxGeometry(24,24,4),P=new THREE.MeshPhongMaterial({color:Colors.brownDark,shading:THREE.FlatShading}),f=new THREE.Mesh(S,P);f.position.set(25,-28,25);var x=new THREE.BoxGeometry(10,10,6),C=new THREE.MeshPhongMaterial({color:Colors.brown,shading:THREE.FlatShading}),z=new THREE.Mesh(x,C);f.add(z),this.mesh.add(f);var L=R.clone();L.position.z=-R.position.z,this.mesh.add(L);var b=f.clone();b.position.z=-f.position.z,this.mesh.add(b);var D=f.clone();D.scale.set(.5,.5,.5),D.position.set(-35,-5,0),this.mesh.add(D);var B=new THREE.BoxGeometry(4,20,4);B.applyMatrix((new THREE.Matrix4).makeTranslation(0,10,0));var I=new THREE.MeshPhongMaterial({color:Colors.red,shading:THREE.FlatShading}),F=new THREE.Mesh(B,I);F.position.set(-35,-5,0),F.rotation.z=-.3,this.mesh.add(F),this.pilot=new Pilot,this.pilot.mesh.position.set(-10,27,0),this.mesh.add(this.pilot.mesh),this.mesh.castShadow=!0,this.mesh.receiveShadow=!0}}class Pilot{constructor(){this.mesh=new THREE.Object3D,this.mesh.name="pilot",this.angleHairs=0;var e=new THREE.BoxGeometry(15,15,15),a=new THREE.MeshPhongMaterial({color:Colors.brown,shading:THREE.FlatShading}),s=new THREE.Mesh(e,a);s.position.set(2,-12,0),this.mesh.add(s);var n=new THREE.BoxGeometry(10,10,10),t=new THREE.MeshLambertMaterial({color:Colors.pink}),i=new THREE.Mesh(n,t);this.mesh.add(i);var o=new THREE.BoxGeometry(4,4,4),r=new THREE.MeshLambertMaterial({color:Colors.brown}),h=new THREE.Mesh(o,r);h.geometry.applyMatrix((new THREE.Matrix4).makeTranslation(0,2,0));var l=new THREE.Object3D;this.hairsTop=new THREE.Object3D;for(var m=0;m<12;m++){var d=h.clone(),c=m%3,p=Math.floor(m/3);d.position.set(4*p-4,0,4*c-4),this.hairsTop.add(d)}l.add(this.hairsTop);var g=new THREE.BoxGeometry(12,4,2);g.applyMatrix((new THREE.Matrix4).makeTranslation(-6,0,0));var E=new THREE.Mesh(g,r),w=E.clone();E.position.set(8,-2,6),w.position.set(8,-2,-6),l.add(E),l.add(w);var v=new THREE.BoxGeometry(2,8,10),M=new THREE.Mesh(v,r);M.position.set(-1,-4,0),l.add(M),l.position.set(-5,5,0),this.mesh.add(l);var y=new THREE.BoxGeometry(5,5,5),T=new THREE.MeshLambertMaterial({color:Colors.brown}),u=new THREE.Mesh(y,T);u.position.set(6,0,3);var H=u.clone();H.position.z=-u.position.z;var R=new THREE.BoxGeometry(11,1,11),S=new THREE.Mesh(R,T);this.mesh.add(u),this.mesh.add(H),this.mesh.add(S);var P=new THREE.BoxGeometry(2,3,2),f=new THREE.Mesh(P,t);f.position.set(0,0,-6);var x=f.clone();x.position.set(0,0,6),this.mesh.add(f),this.mesh.add(x)}}function createPlane(){(airplane=new AirPlane).mesh.scale.set(.25,.25,.25),airplane.mesh.position.y=game.planeDefaultHeight,scene.add(airplane.mesh)}Pilot.prototype.updateHairs=function(){for(var e=this.hairsTop.children,a=e.length,s=0;s<a;s++)e[s].scale.y=.75+.25*Math.cos(this.angleHairs+s/3);this.angleHairs+=.16};class Ennemy{constructor(){var e=new THREE.TetrahedronGeometry(8,2),a=new THREE.MeshPhongMaterial({color:Colors.red,shininess:0,specular:16777215,shading:THREE.FlatShading});this.mesh=new THREE.Mesh(e,a),this.mesh.castShadow=!0,this.angle=0,this.dist=0}}class EnnemiesHolder{constructor(){this.mesh=new THREE.Object3D,this.ennemiesInUse=[]}}EnnemiesHolder.prototype.spawnEnnemies=function(){for(var e=game.level,a=0;a<e;a++){var s;(s=ennemiesPool.length?ennemiesPool.pop():new Ennemy).angle=-.1*a,s.distance=game.seaRadius+game.planeDefaultHeight+(2*Math.random()-1)*(game.planeAmpHeight-20),s.mesh.position.y=-game.seaRadius+Math.sin(s.angle)*s.distance,s.mesh.position.x=Math.cos(s.angle)*s.distance,this.mesh.add(s.mesh),this.ennemiesInUse.push(s)}},EnnemiesHolder.prototype.rotateEnnemies=function(){for(var e=0;e<this.ennemiesInUse.length;e++){var a=this.ennemiesInUse[e];a.angle+=game.speed*deltaTime*game.ennemiesSpeed,a.angle>2*Math.PI&&(a.angle-=2*Math.PI),a.mesh.position.y=-game.seaRadius+Math.sin(a.angle)*a.distance,a.mesh.position.x=Math.cos(a.angle)*a.distance,a.mesh.rotation.z+=.1*Math.random(),a.mesh.rotation.y+=.1*Math.random();var s=airplane.mesh.position.clone().sub(a.mesh.position.clone()),n=s.length();n<game.ennemyDistanceTolerance?(particlesHolder.spawnParticles(a.mesh.position.clone(),15,Colors.red,3),ennemiesPool.unshift(this.ennemiesInUse.splice(e,1)[0]),this.mesh.remove(a.mesh),game.planeCollisionSpeedX=100*s.x/n,game.planeCollisionSpeedY=100*s.y/n,ambientLight.intensity=2,removeEnergy(),e--):a.angle>Math.PI&&(ennemiesPool.unshift(this.ennemiesInUse.splice(e,1)[0]),this.mesh.remove(a.mesh),e--)}};class Particle{constructor(){var e=new THREE.TetrahedronGeometry(3,0),a=new THREE.MeshPhongMaterial({color:39321,shininess:0,specular:16777215,shading:THREE.FlatShading});this.mesh=new THREE.Mesh(e,a)}}Particle.prototype.explode=function(e,a,s){var n=this,t=this.mesh.parent;this.mesh.material.color=new THREE.Color(a),this.mesh.material.needsUpdate=!0,this.mesh.scale.set(s,s,s);var i=e.x+50*(2*Math.random()-1),o=e.y+50*(2*Math.random()-1),r=.6+.2*Math.random();TweenMax.to(this.mesh.rotation,r,{x:12*Math.random(),y:12*Math.random()}),TweenMax.to(this.mesh.scale,r,{x:.1,y:.1,z:.1}),TweenMax.to(this.mesh.position,r,{x:i,y:o,delay:.1*Math.random(),ease:Power2.easeOut,onComplete:function(){t&&t.remove(n.mesh),n.mesh.scale.set(1,1,1),particlesPool.unshift(n)}})};class ParticlesHolder{constructor(){this.mesh=new THREE.Object3D,this.particlesInUse=[]}}ParticlesHolder.prototype.spawnParticles=function(e,a,s,n){for(var t=a,i=0;i<t;i++){var o;o=particlesPool.length?particlesPool.pop():new Particle,this.mesh.add(o.mesh),o.mesh.visible=!0,o.mesh.position.y=e.y,o.mesh.position.x=e.x,o.explode(e,s,n)}};class Coin{constructor(){var e=new THREE.TetrahedronGeometry(5,0),a=new THREE.MeshPhongMaterial({color:39321,shininess:0,specular:16777215,shading:THREE.FlatShading});this.mesh=new THREE.Mesh(e,a),this.mesh.castShadow=!0,this.angle=0,this.dist=0}}class CoinsHolder{constructor(e){this.mesh=new THREE.Object3D,this.coinsInUse=[],this.coinsPool=[];for(var a=0;a<e;a++){var s=new Coin;this.coinsPool.push(s)}}}function createCoins(){coinsHolder=new CoinsHolder(20),scene.add(coinsHolder.mesh)}function createEnnemies(){for(var e=0;e<10;e++){var a=new Ennemy;ennemiesPool.push(a)}ennemiesHolder=new EnnemiesHolder,scene.add(ennemiesHolder.mesh)}function createParticles(){for(var e=0;e<10;e++){var a=new Particle;particlesPool.push(a)}particlesHolder=new ParticlesHolder,scene.add(particlesHolder.mesh)}CoinsHolder.prototype.spawnCoins=function(){for(var e=1+Math.floor(10*Math.random()),a=game.seaRadius+game.planeDefaultHeight+(2*Math.random()-1)*(game.planeAmpHeight-20),s=10+Math.round(10*Math.random()),n=0;n<e;n++){var t;t=this.coinsPool.length?this.coinsPool.pop():new Coin,this.mesh.add(t.mesh),this.coinsInUse.push(t),t.angle=-.02*n,t.distance=a+Math.cos(.5*n)*s,t.mesh.position.y=-game.seaRadius+Math.sin(t.angle)*t.distance,t.mesh.position.x=Math.cos(t.angle)*t.distance}},CoinsHolder.prototype.rotateCoins=function(){for(var e=0;e<this.coinsInUse.length;e++){var a=this.coinsInUse[e];a.exploding||(a.angle+=game.speed*deltaTime*game.coinsSpeed,a.angle>2*Math.PI&&(a.angle-=2*Math.PI),a.mesh.position.y=-game.seaRadius+Math.sin(a.angle)*a.distance,a.mesh.position.x=Math.cos(a.angle)*a.distance,a.mesh.rotation.z+=.1*Math.random(),a.mesh.rotation.y+=.1*Math.random(),airplane.mesh.position.clone().sub(a.mesh.position.clone()).length()<game.coinDistanceTolerance?(this.coinsPool.unshift(this.coinsInUse.splice(e,1)[0]),this.mesh.remove(a.mesh),particlesHolder.spawnParticles(a.mesh.position.clone(),5,39321,.8),addEnergy(),e--):a.angle>Math.PI&&(this.coinsPool.unshift(this.coinsInUse.splice(e,1)[0]),this.mesh.remove(a.mesh),e--))}};const hemisphereLight=new THREE.HemisphereLight(11184810,0,.9),ambientLight=new THREE.AmbientLight(14452852,.5),shadowLight=new THREE.DirectionalLight(16777215,.9);shadowLight.position.set(150,350,350),shadowLight.castShadow=!0,shadowLight.shadow.camera.left=-400,shadowLight.shadow.camera.right=400,shadowLight.shadow.camera.top=400,shadowLight.shadow.camera.bottom=-400,shadowLight.shadow.camera.near=1,shadowLight.shadow.camera.far=1e3,shadowLight.shadow.mapSize.width=2048,shadowLight.shadow.mapSize.height=2048,scene.add(hemisphereLight),scene.add(shadowLight),scene.add(ambientLight);const sizes={width:window.innerWidth,height:window.innerHeight},camera=new THREE.PerspectiveCamera(60,sizes.width/sizes.height,1,1e4);camera.position.x=0,camera.position.y=100,camera.position.z=200,scene.add(camera);const renderer=new THREE.WebGLRenderer({canvas,alpha:!0,antialias:!0});renderer.setSize(sizes.width,sizes.height),renderer.setPixelRatio(Math.min(window.devicePixelRatio,1)),renderer.shadowMap.enabled=!0,window.addEventListener("resize",(()=>{sizes.width=window.innerWidth,sizes.height=window.innerHeight,camera.aspect=sizes.width/sizes.height,camera.updateProjectionMatrix(),renderer.setSize(sizes.width,sizes.height),renderer.setPixelRatio(Math.min(window.devicePixelRatio,1))}));var mousePos={x:0,y:0};function handleMouseMove(e){var a=e.clientX/sizes.width*2-1,s=1-e.clientY/sizes.height*2;mousePos={x:a,y:s}}function handleTouchMove(e){e.preventDefault();var a=e.touches[0].pageX/sizes.width*2-1,s=1-e.touches[0].pageY/sizes.height*2;mousePos={x:a,y:s}}function handleMouseUp(e){"waitingReplay"==game.status&&(resetGame(),hideReplay())}function handleTouchEnd(e){"waitingReplay"==game.status&&(resetGame(),hideReplay())}function updateCameraFov(){camera.fov=normalize(mousePos.x,-1,1,40,80),camera.updateProjectionMatrix()}function updateDistance(){game.distance+=game.speed*deltaTime*game.ratioSpeedDistance,fieldDistance.innerHTML=Math.floor(game.distance);var e=502*(1-game.distance%game.distanceForLevelUpdate/game.distanceForLevelUpdate);levelCircle.setAttribute("stroke-dashoffset",e)}document.addEventListener("mousemove",handleMouseMove,!1);var fieldDistance,energyBar,replayMessage,fieldLevel,levelCircle,blinkEnergy=!1;function updateEnergy(){game.energy-=game.speed*deltaTime*game.ratioSpeedEnergy,game.energy=Math.max(0,game.energy),energyBar.style.right=100-game.energy+"%",energyBar.style.backgroundColor=game.energy<50?"#f25346":"#68c3c0",game.energy<30?energyBar.style.animationName="blinking":energyBar.style.animationName="none",game.energy<1&&(game.status="gameover")}function addEnergy(){game.energy+=game.coinValue,game.energy=Math.min(game.energy,100)}function removeEnergy(){game.energy-=game.ennemyValue,game.energy=Math.max(0,game.energy)}function updatePlane(){game.planeSpeed=normalize(mousePos.x,-.5,.5,game.planeMinSpeed,game.planeMaxSpeed);var e=normalize(mousePos.y,-.75,.75,25,175),a=normalize(mousePos.x,-.75,.75,-1,1);game.planeCollisionDisplacementX+=game.planeCollisionSpeedX,a+=game.planeCollisionDisplacementX,game.planeCollisionDisplacementY+=game.planeCollisionSpeedY,e+=game.planeCollisionDisplacementY,airplane.mesh.position.y+=(e-airplane.mesh.position.y)*deltaTime*game.planeMoveSensivity,airplane.mesh.position.x+=(a-airplane.mesh.position.x)*deltaTime*game.planeMoveSensivity,airplane.mesh.rotation.z=(e-airplane.mesh.position.y)*deltaTime*game.planeRotXSensivity,airplane.mesh.rotation.x=(airplane.mesh.position.y-e)*deltaTime*game.planeRotZSensivity,normalize(game.planeSpeed,game.planeMinSpeed,game.planeMaxSpeed,game.cameraNearPos,game.cameraFarPos),camera.fov=normalize(mousePos.x,-1,1,40,80),camera.updateProjectionMatrix(),camera.position.y+=(airplane.mesh.position.y-camera.position.y)*deltaTime*game.cameraSensivity,game.planeCollisionSpeedX+=(0-game.planeCollisionSpeedX)*deltaTime*.03,game.planeCollisionDisplacementX+=(0-game.planeCollisionDisplacementX)*deltaTime*.01,game.planeCollisionSpeedY+=(0-game.planeCollisionSpeedY)*deltaTime*.03,game.planeCollisionDisplacementY+=(0-game.planeCollisionDisplacementY)*deltaTime*.01,airplane.pilot.updateHairs()}function showReplay(){replayMessage.style.display="block"}function hideReplay(){replayMessage.style.display="none"}function normalize(e,a,s,n,t){return n+(Math.max(Math.min(e,s),a)-a)/(s-a)*(t-n)}const clock=new THREE.Clock;oldTime=0;const tick=()=>{clock.getElapsedTime(),newTime=(new Date).getTime(),deltaTime=newTime-oldTime,oldTime=newTime,"playing"==game.status?(Math.floor(game.distance)%game.distanceForCoinsSpawn==0&&Math.floor(game.distance)>game.coinLastSpawn&&(game.coinLastSpawn=Math.floor(game.distance),coinsHolder.spawnCoins()),Math.floor(game.distance)%game.distanceForSpeedUpdate==0&&Math.floor(game.distance)>game.speedLastUpdate&&(game.speedLastUpdate=Math.floor(game.distance),game.targetBaseSpeed+=game.incrementSpeedByTime*deltaTime),Math.floor(game.distance)%game.distanceForEnnemiesSpawn==0&&Math.floor(game.distance)>game.ennemyLastSpawn&&(game.ennemyLastSpawn=Math.floor(game.distance),ennemiesHolder.spawnEnnemies()),Math.floor(game.distance)%game.distanceForLevelUpdate==0&&Math.floor(game.distance)>game.levelLastUpdate&&(game.levelLastUpdate=Math.floor(game.distance),game.level++,fieldLevel.innerHTML=Math.floor(game.level),game.targetBaseSpeed=game.initSpeed+game.incrementSpeedByLevel*game.level),updatePlane(),updateDistance(),updateEnergy(),game.baseSpeed+=(game.targetBaseSpeed-game.baseSpeed)*deltaTime*.02,game.speed=game.baseSpeed*game.planeSpeed):"gameover"==game.status?(game.speed*=.99,airplane.mesh.rotation.z+=2e-4*(-Math.PI/2-airplane.mesh.rotation.z)*deltaTime,airplane.mesh.rotation.x+=3e-4*deltaTime,game.planeFallSpeed*=1.05,airplane.mesh.position.y-=game.planeFallSpeed*deltaTime,airplane.mesh.position.y<-200&&(showReplay(),game.status="waitingReplay")):game.status,airplane.propeller.rotation.x+=.2+game.planeSpeed*deltaTime*.005,sea.mesh.rotation.z+=game.speed*deltaTime,sea.mesh.rotation.z>2*Math.PI&&(sea.mesh.rotation.z-=2*Math.PI),ambientLight.intensity+=(.5-ambientLight.intensity)*deltaTime*.005,coinsHolder.rotateCoins(),ennemiesHolder.rotateEnnemies(),sky.moveClouds(),sea.moveWaves(),renderer.render(scene,camera),window.requestAnimationFrame(tick)};function init(e){fieldDistance=document.getElementById("distValue"),energyBar=document.getElementById("energyBar"),replayMessage=document.getElementById("replayMessage"),fieldLevel=document.getElementById("levelValue"),levelCircle=document.getElementById("levelCircleStroke"),resetGame(),createPlane(),createSea(),createSky(),createCoins(),createEnnemies(),createParticles(),document.addEventListener("mousemove",handleMouseMove,!1),document.addEventListener("touchmove",handleTouchMove,!1),document.addEventListener("mouseup",handleMouseUp,!1),document.addEventListener("touchend",handleTouchEnd,!1),tick()}window.addEventListener("load",init,!1);